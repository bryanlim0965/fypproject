<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Live Search Test</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    #searchBox {
      width: 300px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    #results {
      position: absolute;
      background: white;
      border: 1px solid #ccc;
      width: 300px;
      display: none;
      max-height: 200px;
      overflow-y: auto;
      border-radius: 4px;
    }
    .result-item {
      padding: 8px;
      cursor: pointer;
    }
    .result-item:hover {
      background: #f0f0f0;
    }
  </style>
</head>
<body>
  <h2>ðŸŽ® Live Game Search</h2>
  <input type="text" id="searchBox" placeholder="Search games..." autocomplete="off">
  <div id="results"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // âœ… Your Firebase config here
   const firebaseConfig = {
  apiKey: "AIzaSyCnIL_Lg-sEQs-52YRUL9PTaWTWc4Xu5xA",
  authDomain: "final-year-b1cc2.firebaseapp.com",
  projectId: "final-year-b1cc2",
  storageBucket: "final-year-b1cc2.appspot.com", // âœ… fixed here
  messagingSenderId: "537245015385",
  appId: "1:537245015385:web:ab79c9ec5e2a74cc924048",
  measurementId: "G-V6SWSF6F2D"
};


    console.log("[LIVESEARCH] initializing Firebase...");
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const searchBox = document.getElementById("searchBox");
    const results = document.getElementById("results");
    const games = [];

    async function loadGames() {
      console.log("[LIVESEARCH] Loading games...");
      const querySnapshot = await getDocs(collection(db, "games"));
      querySnapshot.forEach((doc) => {
        games.push({ id: doc.id, ...doc.data() });
      });
      console.log(`[LIVESEARCH] Loaded ${games.length} games`);
    }

    function showResults(list) {
      results.innerHTML = "";
      if (list.length === 0) {
        results.style.display = "none";
        return;
      }
      list.slice(0, 5).forEach(game => {
        const item = document.createElement("div");
        item.classList.add("result-item");
        item.textContent = game.name;
        item.onclick = () => window.location.href = `game.html?id=${game.id}`;
        results.appendChild(item);
      });
      results.style.display = "block";
    }

    searchBox.addEventListener("input", e => {
      const q = e.target.value.toLowerCase().trim();
      if (!q) {
        results.style.display = "none";
        return;
      }
      const filtered = games.filter(g => g.name && g.name.toLowerCase().includes(q));
      showResults(filtered);
    });

    loadGames();
  </script>
</body>
</html>
