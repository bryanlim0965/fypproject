  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Game Store</title>

    <!-- Fonts + Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"/>
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet"/>

    <!-- Styles -->
    <link rel="stylesheet" href="landing.css" />
    

    <style>
    
    /* Support Ticket Styles */
    /* üßæ Support Ticket Styles - modernized */
.support-section {
  padding: 60px 20px;
  max-width: 700px;
  margin: 0 auto;
  color: #fff;
  text-align: center;
}

.support-section h2 {
  color: #ff4757;
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 10px;
}

.support-section p {
  color: #bbb;
  margin-bottom: 30px;
}

.support-form {
    text-align: left;
  display: flex;
  flex-direction: column;
  gap: 18px;
  background: rgba(20, 20, 20, 0.9);
  border: 1px solid #2b2b2b;
  border-radius: 18px;
  padding: 30px;
  box-shadow: 0 8px 25px rgba(0,0,0,.4);
  backdrop-filter: blur(4px);
}
.support-form label {
  text-align: left;
  display: block;
  color: #e8e8e8;
  font-weight: 600;
  margin-bottom: 6px;
}

.support-form input,
.support-form textarea {
  width: 100%;
  background: #0d0d0d;
  color: #fff;
  border: 1px solid #333;
  border-radius: 10px;
  padding: 14px 16px;
  font-size: 1rem;
  font-family: "Poppins", sans-serif;
  transition: border-color 0.2s ease, background 0.2s ease;
}

.support-form input:focus,
.support-form textarea:focus {
  outline: none;
  border-color: #ff4757;
  background: #141414;
}

.support-form textarea {
  resize: vertical;
  min-height: 130px;
}

.support-form button {
  background: #ff2e2e;
  color: #fff;
  font-weight: 600;
  font-size: 1.05rem;
  padding: 14px;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.support-form button:hover {
  filter: brightness(1.1);
  transform: translateY(-1px);
}

.success-msg {
  background: #28a745;
  color: #fff;
  border-radius: 10px;
  padding: 14px;
  text-align: center;
  margin-top: 25px;
  display: none;
  font-weight: 600;
}

.call-section {
  text-align: center;
  margin-top: 40px;
}

.call-section a {
  color: #00ff99;
  font-weight: 700;
  font-size: 1.1rem;
  text-decoration: none;
}

.call-section a:hover {
  text-decoration: underline;
}

  </style>

    <style>
      /* Grid */
.games-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(220px, 1fr));
  gap:24px;
  align-items:stretch;
}

/* Card shell (fixed overall height for consistency) */
.game-card{
  display:flex;
  flex-direction:column;
  background:#1a1a1a;
  border:1px solid #262626;
  border-radius:16px;
  overflow:hidden;
  height: 380px;              /* <- constant total height */
  box-shadow:0 4px 15px rgba(0,0,0,.2);
  transition:transform .2s ease;
  cursor:pointer;
}
.game-card:hover{ transform:scale(1.03); }

/* Image: fixed aspect, always same visual height */
.game-thumb{
  width:100%;
  aspect-ratio: 3 / 4;        /* consistent poster shape */
  object-fit:cover;
  display:block;
}

/* Content area */
.game-body{
  display:flex;
  flex-direction:column;
  gap:6px;
  padding:12px;
  flex:1;                     /* take remaining space so actions stay at bottom */
}

/* Title: clamp to 2 lines so all cards align */
.game-title{
  color:#fff;
  font-size:1rem;
  font-weight:700;
  line-height:1.25;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
  min-height:2.6em;           /* reserves space for two lines */
}

/* Price sticks near bottom of body */
.game-price{
  color:#ccc;
  font-size:.9rem;
  margin-top:auto;            /* pushes price to the bottom of body */
}

/* Buttons sit in a fixed footer row */
.game-actions{
  display:flex;
  gap:8px;
  justify-content:center;
  padding:12px;
  border-top:1px solid #262626;
}

.btn{
  background:#333;
  color:#fff;
  border:none;
  padding:8px 12px;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
}
.btn-primary{ background:#ff4757; }
.btn:hover{ filter:brightness(1.1); }

      /* === User menu (account card) === */
      .user-menu{ position:relative; display:none; }
      .user-btn{
        display:inline-flex; align-items:center; justify-content:center;
        width:44px; height:44px; border-radius:999px;
        background:#1a1a1a; border:1px solid #262626; color:#e8e8e8;
        font-size:1.4rem; cursor:pointer; transition:background .15s ease, color .15s ease;
      }
      .user-btn:hover{ background:#222; }
      .user-btn.logged-in { color: #00ff00; } /* green after login */

      .user-card{
        position:absolute; top:calc(100% + 10px); right:0; min-width:280px;
        background:#111; border:1px solid #222; border-radius:16px;
        box-shadow:0 18px 40px rgba(0,0,0,.5); padding:12px; display:none; z-index:4000;
      }
      .user-menu.open .user-card{ display:block; }

      .uc-header{
        display:flex; align-items:center; gap:12px;
        padding:12px; border-radius:12px; background:#151515; border:1px solid #222;
        margin-bottom:10px;
      }
      .uc-avatar{
        width:42px; height:42px; border-radius:50%;
        display:flex; align-items:center; justify-content:center;
        background:#28a745; color:#fff; font-weight:800;
        transition: background .15s ease, color .15s ease;
      }
      .uc-avatar.logged-in { background: #00ff00; color:#111; } /* green avatar */
      
      .uc-ident{ line-height:1.2; }
      .uc-name{ font-weight:800; color:#fff; }
      .uc-points{ font-size:.85rem; color:#bdbdbd; }
      .uc-items{ padding:6px 0; }
      .uc-item{
        width:100%; display:flex; align-items:center; gap:10px;
        padding:10px 12px; color:#eaeaea; background:transparent; border:none;
        text-decoration:none; border-radius:10px; cursor:pointer; font-weight:700;
        transition:background .15s ease, color .15s ease, transform .05s ease;
      }
      .uc-item i{ font-size:1.1rem; }
      .uc-item:hover{ background:#1b1b1d; color:#fff; }
      .uc-logout{
        width:100%; text-align:left; margin-top:6px; color:#ff8080;
      }
      .uc-logout:hover{ background:#1b1b1d; color:#ffb3b3; }
    </style>
  </head>
  <body>

    <!-- ===== Top Header / Nav ===== -->
    <header class="topbar">
      <div class="topbar-row">
        <a href="landing.html" class="brand"><img src="Images/logo.png" alt="Brand Logo"></a>

        <form class="search" action="#" method="get">
          <input type="text" name="q" placeholder="Search" aria-label="Search games, consoles, accessories" />
          <button type="submit" aria-label="Search"><i class='bx bx-search'></i></button>
        </form>

        <div class="actions">
          <a href="#" class="redeem"><i class='bx bxs-hot'></i> <span>REDEEM</span></a>

          <!-- Login pill -->
          <a href="login.html" id="loginBtn" class="icon-btn" aria-label="Login">
            <i class='bx bx-user'></i><span class="label">Login</span>
          </a>

          <!-- User icon + dropdown -->
          <div class="user-menu" id="userMenu">
            <button class="user-btn" id="userBtn" aria-expanded="false" aria-haspopup="true">
              <i class='bx bx-user-circle'></i>
            </button>

            <div class="user-dropdown user-card" id="userDropdown" role="menu">
              <div class="uc-header">
                <div class="uc-avatar" id="userAvatar">U</div>
                <div class="uc-ident">
                  <div class="uc-name" id="userNameLarge">User</div>
                  <div class="uc-points" id="userPoints">0 Points</div>
                </div>
              </div>

              <div class="uc-items">
                <a href="profile.html" class="uc-item"><i class='bx bx-id-card'></i> Profile</a>
                <a href="orders.html" class="uc-item"><i class='bx bx-package'></i> Orders</a>
                <a href="mytickets.html" class="uc-item"><i class='bx bx-list-check'></i> My Tickets</a>

                <a href="tickets.html" class="uc-item"><i class='bx bx-support'></i> Need Help?</a>
              </div>

              <button class="uc-item uc-logout" id="logoutBtn"><i class='bx bx-log-out'></i> Logout</button>
            </div>
          </div>

          <a href="cart.html" class="icon-btn cart" aria-label="Cart">
            <i class='bx bx-cart'></i><span class="count" id="cartCount">0</span>
          </a>
        </div>
      </div>

      <!-- Global nav -->
      <nav class="mainnav" aria-label="Main navigation">
        <ul>
          <li><a href="landing.html">HOME</a></li>
          <li class="has-sub">
            <button class="nav-link">CONSOLES <i class='bx bx-chevron-down'></i></button>
            <ul class="submenu">
              <li><a href="consoles.html?platform=PS">PS</a></li>
    <li><a href="consoles.html?platform=Xbox">Xbox</a></li>
    <li><a href="consoles.html?platform=Nintendo Switch">Nintendo</a></li>
            </ul>
          </li>
          <li class="has-sub">
  <button class="nav-link">GAMES <i class='bx bx-chevron-down'></i></button>
  <ul class="submenu">
    <li><a href="games.html?platform=PS5">PS5</a></li>
    <li><a href="games.html?platform=PS4">PS4</a></li>
    <li><a href="games.html?platform=Xbox">Xbox</a></li>
    <li><a href="games.html?platform=Nintendo%20Switch">Nintendo</a></li>
  </ul>
</li>

          <li class="has-sub">
          <button class="nav-link">GAMING PERIPHERALS <i class='bx bx-chevron-down'></i></button>
          <ul class="submenu">
            <li><a href="items.html?category=peripherals&platform=kb">Keyboards</a></li>
            <li><a href="items.html?category=peripherals&platform=mice">Mice</a></li>
            <li><a href="items.html?category=peripherals&platform=monitor">Monitors</a></li>
          </ul>
        </li>
        <li class="has-sub">
          <button class="nav-link">TOYS & COLLECTIBLES <i class='bx bx-chevron-down'></i></button>
          <ul class="submenu">
            <li><a href="items.html?category=toys&platform=LE">Limited Editions</a></li>
            <li><a href="items.html?category=toys&platform=figures">Figures</a></li>
          </ul>
        </li>
        <li class="has-sub">
          <button class="nav-link">LIFE STYLE & MERCHANDISE <i class='bx bx-chevron-down'></i></button>
          <ul class="submenu">
            <li><a href="items.html?category=lifestyle&platform=apparel">Apparel</a></li>
            <li><a href="items.html?category=lifestyle&platform=bag">Bags</a></li>
          </ul>
        </li>
        </ul>
      </nav>
    </header>

    <section class="support-section">
    <h2>Submit a Support Ticket</h2>
    <p>Need help? Fill in the form below and our team will get back to you as soon as possible.</p>

    <form id="ticketForm" class="support-form">
      <div>
        <label for="name">Name</label>
        <input type="text" id="name" placeholder="Your name" required />
      </div>
      <div>
        <label for="email">Email</label>
        <input type="email" id="email" placeholder="your@email.com" required />
      </div>
      <div>
        <label for="subject">Subject</label>
        <input type="text" id="subject" placeholder="Subject of your issue" required />
      </div>
      <div>
        <label for="message">Message</label>
        <textarea id="message" placeholder="Describe your issue..." required></textarea>
      </div>
      <button type="submit">Submit Ticket</button>
    </form>

    <div id="successMsg" class="success-msg">‚úÖ Your ticket has been submitted successfully!</div>

    <div class="call-section">
      <p>Prefer to talk? üìû Call <a href="tel:0164469222">Rav Store at 016-446 9222</a></p>
    </div>
  </section>

  <!-- === Firebase Ticket Submission === -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCnIL_Lg-sEQs-52YRUL9PTaWTWc4Xu5xA",
      authDomain: "final-year-b1cc2.firebaseapp.com",
      projectId: "final-year-b1cc2",
      storageBucket: "final-year-b1cc2.firebasestorage.app",
      messagingSenderId: "537245015385",
      appId: "1:537245015385:web:ab79c9ec5e2a74cc924048",
      measurementId: "G-V6SWSF6F2D"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const nameInput = document.getElementById("name");
    const emailInput = document.getElementById("email");
    const subjectInput = document.getElementById("subject");
    const messageInput = document.getElementById("message");
    const form = document.getElementById("ticketForm");
    const successMsg = document.getElementById("successMsg");

    let currentUser = null;

    onAuthStateChanged(auth, (user) => {
      if (user) {
        currentUser = user;
        nameInput.value = user.displayName || localStorage.getItem("name") || "";
        emailInput.value = user.email;
      }
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const name = nameInput.value.trim();
      const email = emailInput.value.trim();
      const subject = subjectInput.value.trim();
      const message = messageInput.value.trim();

      if (!name || !email || !subject || !message) {
        alert("Please fill in all fields.");
        return;
      }

      try {
      
const ticketRef = await addDoc(collection(db, "tickets"), {
  name,
  email,
  subject,
  uid: currentUser ? currentUser.uid : null,
  status: "Open",
  createdAt: serverTimestamp()
});

// üü¢ Add the first message to the chat (subcollection)
await addDoc(collection(db, "tickets", ticketRef.id, "messages"), {
  sender: "user",
  text: message,
  timestamp: serverTimestamp()
});


        form.reset();
        successMsg.style.display = "block";
        setTimeout(() => successMsg.style.display = "none", 4000);
      } catch (err) {
        console.error("Error submitting ticket:", err);
        alert("Failed to submit your ticket. Please try again later.");
      }
    });
  </script>

   

    <!-- Firebase + user points logic -->
    <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCnIL_Lg-sEQs-52YRUL9PTaWTWc4Xu5xA",
    authDomain: "final-year-b1cc2.firebaseapp.com",
    projectId: "final-year-b1cc2",
    storageBucket: "final-year-b1cc2.firebasestorage.app",
    messagingSenderId: "537245015385",
    appId: "1:537245015385:web:ab79c9ec5e2a74cc924048",
    measurementId: "G-V6SWSF6F2D"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const loginBtn   = document.getElementById("loginBtn");
  const userMenu   = document.getElementById("userMenu");
  const userBtn    = document.getElementById("userBtn");
  const userNameLg = document.getElementById("userNameLarge");
  const userPoints = document.getElementById("userPoints");
  const userAvatar = document.getElementById("userAvatar");
  const logoutBtn  = document.getElementById("logoutBtn");

  function initialsFrom(nameOrEmail){
    const base = (nameOrEmail || "User").trim();
    const parts = base.includes("@") ? [base.split("@")[0]] : base.split(" ");
    const letters = parts.filter(Boolean).slice(0,2).map(s => s[0].toUpperCase());
    return letters.join('') || 'U';
  }

  function showLoggedInDisplay(name, points, email){
    if(loginBtn) loginBtn.style.display = "none";
    if(userMenu) userMenu.style.display = "inline-flex";
    if(userNameLg) userNameLg.textContent = name || "User";
    if(userPoints) userPoints.textContent = `${points || 0} Points`;
    if(userAvatar){
      userAvatar.textContent = initialsFrom(email || name);
      userAvatar.classList.add('logged-in'); // green avatar
    }
    if(userBtn) userBtn.classList.add('logged-in'); // green button
  }

  function showLoggedOutDisplay(){
    if(loginBtn) loginBtn.style.display = "inline-flex";
    if(userMenu) userMenu.style.display = "none";
    if(userAvatar) userAvatar.classList.remove('logged-in');
    if(userBtn) userBtn.classList.remove('logged-in');
  }

  // Instant display if stored in localStorage
 let name = localStorage.getItem("name");
let points = localStorage.getItem("points");
if (name) showLoggedInDisplay(name, points);

onAuthStateChanged(auth, async (user) => {
  if (user) {
    const userRef = doc(db, "users", user.uid);
    const userSnap = await getDoc(userRef);

    if (!userSnap.exists()) {
      // Create user record if not found
      await setDoc(userRef, {
        name: user.displayName || user.email.split("@")[0],
        email: user.email,
        phone: "",
        points: 0
      });
    }

    const userData = (await getDoc(userRef)).data();

    // Store in localStorage
    localStorage.setItem("name", userData.name);
    localStorage.setItem("points", userData.points);

    // Display user's full name
    showLoggedInDisplay(userData.name, userData.points);
  } else {
    localStorage.removeItem("name");
    localStorage.removeItem("points");
    showLoggedOutDisplay();
  }
});

  // Toggle dropdown
  if (userBtn && userMenu){
    userBtn.addEventListener("click", e=>{
      e.stopPropagation();
      const isOpen = userMenu.classList.toggle("open");
      userBtn.setAttribute("aria-expanded", String(isOpen));
    });
    document.addEventListener("click", e=>{
      if (!userMenu.contains(e.target)){
        userMenu.classList.remove("open");
        userBtn.setAttribute("aria-expanded","false");
      }
    });
    document.addEventListener("keydown", e=>{
      if (e.key === "Escape"){
        userMenu.classList.remove("open");
        userBtn.setAttribute("aria-expanded","false");
      }
    });
  }

  // Logout
  if (logoutBtn){
    logoutBtn.addEventListener("click", async ()=>{
      try { await signOut(auth); } catch {}
      localStorage.removeItem("username");
      localStorage.removeItem("points");
      showLoggedOutDisplay();
      window.location.href = "landing.html";
    });
  }
  </script>

  <!-- üü¢ Load game details dynamically from Firestore -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // Same Firebase config (you can reuse your existing one)
    const firebaseConfig = {
      apiKey: "AIzaSyCnIL_Lg-sEQs-52YRUL9PTaWTWc4Xu5xA",
      authDomain: "final-year-b1cc2.firebaseapp.com",
      projectId: "final-year-b1cc2",
      storageBucket: "final-year-b1cc2.firebasestorage.app",
      messagingSenderId: "537245015385",
      appId: "1:537245015385:web:ab79c9ec5e2a74cc924048",
      measurementId: "G-V6SWSF6F2D"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Get game ID from URL
    const params = new URLSearchParams(window.location.search);
    const gameId = params.get("id");

    // Target elements
    const gameCover = document.querySelector(".game-cover img");
    const gameTitle = document.querySelector(".game-info h2");
    const gamePrice = document.querySelector(".game-info .price");
    const gameDesc  = document.querySelector(".game-info .desc");

    async function loadGameDetails() {
      if (!gameId) {
        gameTitle.textContent = "Game not found";
        gameDesc.textContent = "No game ID was provided in the URL.";
        return;
      }

      try {
        const docRef = doc(db, "games", gameId);
        const snap = await getDoc(docRef);

        if (snap.exists()) {
          const data = snap.data();
          console.log("Loaded game:", data);

          const title = data.title || data.name || "Untitled Game";
          const price = data.price || 0;
          const image = data.image || data.imageURL || "https://via.placeholder.com/400x500?text=No+Image";
          const desc  = data.description || data.desc || "No description available.";

          gameTitle.textContent = title;
          gamePrice.textContent = `RM ${price.toLocaleString()}`;
          gameDesc.textContent  = desc;
          gameCover.src = image;
          gameCover.alt = title;
        } else {
          gameTitle.textContent = "Game not found";
          gameDesc.textContent = "This game may have been removed or does not exist.";
        }
      } catch (err) {
        console.error("Error loading game:", err);
        gameTitle.textContent = "Error loading game";
        gameDesc.textContent = "An unexpected error occurred.";
      }
    }

    loadGameDetails();
  </script>

  <!-- üõí Add to Cart Functionality -->
  <script type="module">
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, updateDoc, increment, collection } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // Reuse Firebase app already initialized above
    const auth = getAuth();
    const db = getFirestore();

    const addToCartBtn = document.querySelector(".add-to-cart");
    const qtyInput = document.getElementById("qty");

    // Get game info from page
    const gameTitle = document.querySelector(".game-info h2");
    const gamePrice = document.querySelector(".game-info .price");
    const gameCover = document.querySelector(".game-cover img");

    addToCartBtn.addEventListener("click", async () => {
      const user = auth.currentUser;

      if (!user) {
        alert("Please log in to add items to your cart.");
        window.location.href = "login.html";
        return;
      }

      const uid = user.uid;
      const gameId = new URLSearchParams(window.location.search).get("id");
      const quantity = parseInt(qtyInput.value) || 1;

      // Prepare cart item data
      const itemData = {
        title: gameTitle.textContent,
        price: parseFloat(gamePrice.textContent.replace(/[^\d.]/g, "")) || 0,
        image: gameCover.src,
        quantity: quantity,
        addedAt: new Date()
      };

      const cartItemRef = doc(db, "users", uid, "cart", gameId);
      const existingSnap = await getDoc(cartItemRef);

      try {
        if (existingSnap.exists()) {
          // Update quantity if item already exists
          await updateDoc(cartItemRef, {
            quantity: increment(quantity)
          });
        } else {
          // Create new cart item
          await setDoc(cartItemRef, itemData);
        }
        alert("‚úÖ Added to cart!");
      } catch (error) {
        console.error("Error adding to cart:", error);
        alert("‚ùå Failed to add item to cart.");
      }
    });
  </script>

  <!-- Firebase + user menu + points -->
  <script type="module">
    // ... your existing Firebase login/logout logic ...
  </script>

  <!-- ‚úÖ Hide cart bubble when logged out / Show when logged in -->
<script type="module">
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const auth = getAuth();
  const db = getFirestore();
  const cartCountEl = document.getElementById("cartCount");

  function updateCartCount(count) {
    if (cartCountEl) {
      cartCountEl.textContent = count;
      // hide bubble completely if zero
      cartCountEl.style.display = count > 0 ? "inline-flex" : "none";
    }
    localStorage.setItem("cartCount", count);
  }

  // Load saved count from localStorage (for smooth transition)
  const savedCount = localStorage.getItem("cartCount");
  if (savedCount !== null) {
    updateCartCount(Number(savedCount));
  } else if (cartCountEl) {
    cartCountEl.style.display = "none";
  }

  onAuthStateChanged(auth, (user) => {
    if (user) {
      // üü¢ Logged in ‚Äî show bubble and listen to Firestore cart
      const cartRef = collection(db, "users", user.uid, "cart");
      onSnapshot(cartRef, (snapshot) => {
        let totalQty = 0;
        snapshot.forEach((doc) => {
          const item = doc.data();
          totalQty += item.quantity || 0;
        });
        updateCartCount(totalQty);
      });
    } else {
      // üî¥ Logged out ‚Äî hide bubble and clear saved count
      localStorage.removeItem("cartCount");
      if (cartCountEl) {
        cartCountEl.textContent = "0";
        cartCountEl.style.display = "none";
      }
    }
  });
</script>

<script src="landing.js?v=10"></script>
</body>
</html>


  <script src="landing.js?v=10"></script>
  </body>
  </html>
